(this.webpackJsonppv251_project=this.webpackJsonppv251_project||[]).push([[0],{173:function(e,t,n){"use strict";n.r(t);var r,o=n(0),a=n.n(o),c=n(16),i=n.n(c),s=(n(82),n(12)),u=n(77),l=n.n(u),f=n(68),h=n(69),v=n.n(h),b=n(17),m=n(1),p=n(2),j=function(e){return e.reduce((function(e,t){return e+t}),0)},d=function(e){var t=Math.ceil(100*(e<0?-e:0)),n=Math.ceil(100*(e>0?e:0));return"rgb(".concat(t,"%, 0%, ").concat(n,"%)")},C=function(e,t){var n=Math.abs(e);return n>=t[0]&&n<=t[1]},g=function(){function e(t,n,r,o){Object(m.a)(this,e),this.name=t,this.columns=n,this.values=void 0,this.itemsCount=void 0,this.itemsCount=r.length,this.values=n.map((function(e,t){return n.map((function(n,a){if(a>=t)return null;var c=r.filter((function(t){return t.hasOwnProperty(n)&&t.hasOwnProperty(e)}));if(!c.length)return 0;var i=c.map((function(e){return e[n]})),s=c.map((function(t){return t[e]}));return o(i,s)}))}))}return Object(p.a)(e,[{key:"dimensionsCount",get:function(){return this.columns.length}}]),e}(),O=function(){function e(t,n,r,o){Object(m.a)(this,e),this.numericalCols=r,this.submatrices=[];var a,c={},i=Object(b.a)(t);try{for(i.s();!(a=i.n()).done;){var u=a.value,l=u[n];null!=l&&(l in c?c[l].push(u):c[l]=[u])}}catch(d){i.e(d)}finally{i.f()}for(var f=0,h=Object.entries(c);f<h.length;f++){var v=Object(s.a)(h[f],2),p=v[0],j=v[1];this.submatrices.push(new g(p,r,j,o))}}return Object(p.a)(e,[{key:"levelsCount",get:function(){return this.submatrices.length}},{key:"numericalColsCount",get:function(){return this.numericalCols.length}}]),e}(),x=["Price","Living_space","Lot","Usable_area","Rooms","Bedrooms","Bathrooms","Floors","Year_built","Year_renovated","Energy_consumption","Garages"],w=["Type","Furnishing_quality","Condition","Heating","State","City","Garagetype"],y=[{value:"pearson",label:"Pearson",func:function(e,t){var n=j(e)/e.length,r=j(t)/t.length,o=e.reduce((function(e,t){return e+Math.pow(t-n,2)}),0)/e.length,a=t.reduce((function(e,t){return e+Math.pow(t-r,2)}),0)/t.length,c=Math.sqrt(o),i=Math.sqrt(a);if(c>0&&i>0){for(var s=0,u=0;u<e.length;u++)s+=(e[u]-n)*(t[u]-r);return s/e.length/(c*i)}return 0}},{value:"spearman",label:"Spearman",func:function(e,t){if(e.length<=1)return 0;for(var n=e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})),r=t.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})),o=0,a=0;a<e.length;a++)o+=Math.pow(n[a][0]-r[a][0],2);return 1-6*o/(e.length*(Math.pow(e.length,2)-1))}}];!function(e){e.PERSPECTIVE="perspective",e.ORTHOGRAPHIC="orthographic"}(r||(r={}));var M=10066329,L=1052688,S=.2,E=n(8),B=n(23),P=n(70),k=function(){var e=Object(B.b)(),t=e.gl,n=e.camera,r=a.a.useMemo((function(){return n.position.set(10,10,-10),new P.a(n,t.domElement)}),[n,t.domElement]);return a.a.useEffect((function(){return function(){r.dispose()}}),[r]),null},V=n(78),D=n(5);var F=n(10),G=function(e){var t=e.font,n=e.matrix,r=e.controlState,o=Object(B.b)(),c=o.camera,i=o.scene,s=o.gl;a.a.useEffect((function(){new V.a(s,i,c)}),[c,i,s]);var u=a.a.useMemo((function(){return function(e,t){var n=new D.Object3D,r=new D.BoxGeometry(1,1,1),o=[];return e.submatrices.forEach((function(e,a){var c=new D.Object3D;e.values.forEach((function(e,n){e.forEach((function(e,o){if(null==e||!C(e,t))return null;var i=new D.Color(d(e)),s=new D.MeshStandardMaterial({color:i,transparent:!0,opacity:Math.abs(e)}),u=new D.Mesh(r,s);u.position.set(o+.5,a+.5,n+.5),u.scale.set(S,S,S),c.add(u)}))})),o.push(c),n.add(c)})),{anchor:n,levelGroups:o}}(n,r.correlationBounds)}),[n,r.correlationBounds]),l=u.anchor,f=u.levelGroups,h=a.a.useMemo((function(){return function(e,t){var n=[],r=new D.Object3D,o=new D.LineBasicMaterial({color:L,side:D.DoubleSide});e.numericalCols.forEach((function(a,c){var i=t.generateShapes(a,.5),s=new D.ShapeGeometry(i);s.rotateX(-Math.PI/2),s.rotateY(Math.PI/2);var u=new D.Mesh(s,o);u.position.z=-1,u.position.x=c+.7,r.add(u),n.push(new D.Vector3(c,0,-5)),n.push(new D.Vector3(c,0,e.numericalColsCount))})),n.push(new D.Vector3(e.numericalColsCount,0,-5)),n.push(new D.Vector3(e.numericalColsCount,0,e.numericalColsCount)),e.numericalCols.forEach((function(a,c){var i=t.generateShapes(a,.5),s=new D.ShapeGeometry(i);s.computeBoundingBox();var u=s.boundingBox.max.x-s.boundingBox.min.x;s.rotateX(-Math.PI/2),s.rotateY(Math.PI);var l=new D.Mesh(s,o);l.position.z=c+.2,l.position.x=e.numericalColsCount+u+1,r.add(l),n.push(new D.Vector3(0,0,c)),n.push(new D.Vector3(e.numericalColsCount+5,0,c))})),n.push(new D.Vector3(0,0,e.numericalColsCount)),n.push(new D.Vector3(e.numericalColsCount+5,0,e.numericalColsCount));var a=(new D.BufferGeometry).setFromPoints(n),c=new D.LineBasicMaterial({color:L}),i=new D.LineSegments(a,c);r.add(i);var s=e.numericalColsCount+20,u=new D.PlaneGeometry(s,s),l=new D.MeshBasicMaterial({color:16777215,side:D.DoubleSide,opacity:.7,transparent:!0});u.rotateX(Math.PI/2);var f=new D.Mesh(u,l);return f.position.y=-.01,f.position.x=e.numericalColsCount/2,f.position.z=e.numericalColsCount/2,r.add(f),r}(n,t)}),[n,t]),v=a.a.useMemo((function(){return function(e,t){for(var n=[],r=new D.Object3D,o=new D.LineBasicMaterial({color:10066329}),a=0;a<e.levelsCount;a++){var c=new D.Object3D,i=[];i.push(new D.Vector3(0,a+1,-5)),i.push(new D.Vector3(0,a+1,e.numericalColsCount));var s=t.generateShapes("".concat(e.submatrices[a].name," (").concat(e.submatrices[a].itemsCount,")"),.5),u=new D.ShapeGeometry(s),l=new D.LineBasicMaterial({color:M,side:D.DoubleSide});u.rotateY(Math.PI/2);var f=new D.Mesh(u,l);f.position.y=a+.3,f.position.z=-1,c.add(f);var h=(new D.BufferGeometry).setFromPoints(i),v=new D.LineSegments(h,o);c.add(v),r.add(c),n.push(c)}return{anchor:r,levelDescriptions:n}}(n,t)}),[n,t]),b=v.anchor,m=v.levelDescriptions;return a.a.useEffect((function(){l.position.y=-r.currentLevel,b.position.y=-r.currentLevel,f.forEach((function(e,t){e.traverse((function(e){if(e instanceof D.Mesh){var n=e,o=t>=r.currentLevel&&t<r.currentLevel+r.visibleLevels?1:S;n.scale.set(o,o,o)}}))})),m.forEach((function(e,t){e.traverse((function(e){e instanceof D.Mesh&&e.material.color.set(t>=r.currentLevel&&t<r.currentLevel+r.visibleLevels?26112:M)}))}))}),[f,m,l,b,r]),Object(F.jsx)(a.a.Fragment,{children:Object(F.jsxs)("group",{position:[.75*-n.numericalColsCount,0,.25*-n.numericalColsCount],children:[Object(F.jsx)("primitive",{object:h}),Object(F.jsx)("primitive",{object:b}),Object(F.jsx)("primitive",{object:l})]})})},_=n(11),I=n(28),N=n(53),T=(n(154),function(e){var t=e.actions,n=e.matrix,r=e.controlState,o=a.a.useRef(null);a.a.useEffect((function(){var e=function(e){switch(e.key){case"ArrowUp":t.setControlState((function(e){return Object(E.a)(Object(E.a)({},e),{},{currentLevel:e.currentLevel>=n.levelsCount-1?0:e.currentLevel+1})}));break;case"ArrowDown":t.setControlState((function(e){return Object(E.a)(Object(E.a)({},e),{},{currentLevel:e.currentLevel<=0?n.levelsCount-1:e.currentLevel-1})}))}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[n]);var c=r.correlationBounds;return a.a.useEffect((function(){if(o.current){var e=o.current,t=e.getContext("2d");if(t){t.clearRect(0,0,e.width,e.height);var r=e.height/n.levelsCount;n.submatrices.forEach((function(e,o){for(var a=0,i=0;i<n.numericalColsCount;i++)for(var s=0;s<n.numericalColsCount;s++)if(!(i<=s)){var u=e.values[i][s];a++,null!=u&&C(u,c)&&(t.globalAlpha=Math.abs(u),t.fillStyle=d(u),t.fillRect(2*a,r*(n.levelsCount-1)-o*r,2,r),t.globalAlpha=1)}}))}}}),[n,c]),Object(F.jsxs)("div",{style:{height:"100%",display:"block",position:"relative"},children:[Object(F.jsx)(I.b,{vertical:!0,min:0,max:n.levelsCount,value:r.currentLevel,onChange:function(e){e===n.levelsCount?t.changeControlState({currentLevel:n.levelsCount-1}):t.changeControlState({currentLevel:e})}}),Object(F.jsx)("canvas",{ref:o,style:{position:"absolute",left:"40px",top:"0px",width:n.numericalColsCount*(n.numericalColsCount-1),height:"100%"}})]})}),R=function(e){var t=e.controlState,n=e.matrix,r=e.actions,o=e.categoryOptions,c=Math.min(10,n.levelsCount);return Object(F.jsxs)(a.a.Fragment,{children:[Object(F.jsxs)("div",{className:"controls-pane controls-left-pane",children:[Object(F.jsx)("div",{className:"controls-label",children:"Categorical variable"}),Object(F.jsx)(N.a,{value:t.currentCategory,onChange:function(e){r.changeControlState({currentLevel:0,currentCategory:e})},options:o}),Object(F.jsx)("br",{}),Object(F.jsx)("div",{className:"controls-label",children:"Correlation coefficient"}),Object(F.jsx)(N.a,{value:t.correlationType,onChange:function(e){console.log("newValue",e),r.changeControlState({correlationType:e})},options:y}),Object(F.jsx)("br",{}),Object(F.jsx)("div",{className:"controls-label",children:"Correlation visibility boundaries"}),Object(F.jsx)(I.a,{min:0,max:1,step:.05,marks:{0:0,.5:.5,1:1},defaultValue:[.5,1],onChange:function(e){r.changeControlState({correlationBounds:e})}}),Object(F.jsx)("br",{}),Object(F.jsx)("div",{className:"controls-label",children:"Levels of interest"}),Object(F.jsx)(I.b,{min:1,max:c,marks:Object(_.a)({1:1},c,c),value:t.visibleLevels,onChange:function(e){return r.changeControlState({visibleLevels:e})}})]}),Object(F.jsx)("div",{className:"controls-pane controls-right-pane",children:Object(F.jsx)(T,{actions:r,matrix:n,controlState:t})})]})},z=function(e){var t=e.data,n=e.font,r=a.a.useMemo((function(){var e=w.map((function(e){var n,r={},o=Object(b.a)(t);try{for(o.s();!(n=o.n()).done;){var a=n.value[e];null!=a&&(a in r?r[a]+=1:r[a]=1)}}catch(c){o.e(c)}finally{o.f()}return[e,r]}));return Object.fromEntries(e)}),[t]),o=a.a.useMemo((function(){return w.map((function(e){return{value:e,label:"".concat(e," (").concat(Object.keys(r[e]).length,")")}}))}),[r]),c=a.a.useState({correlationType:y[0],currentCategory:o[0],correlationBounds:[.5,1],currentLevel:0,visibleLevels:1}),i=Object(s.a)(c,2),u=i[0],l=i[1],f=a.a.useMemo((function(){return new O(t,u.currentCategory.value,x,u.correlationType.func)}),[t,u.currentCategory,u.correlationType]),h={setControlState:l,changeControlState:function(e){return l((function(t){return Object(E.a)(Object(E.a)({},t),e)}))}};return Object(F.jsxs)(a.a.Fragment,{children:[Object(F.jsxs)(B.a,{children:[Object(F.jsx)(k,{}),Object(F.jsx)("ambientLight",{}),Object(F.jsx)("pointLight",{position:[10,10,10]}),Object(F.jsx)("color",{attach:"background",args:[1,1,1]}),Object(F.jsx)(G,{font:n,controlState:u,matrix:f})]}),Object(F.jsx)(R,{controlState:u,matrix:f,actions:h,categoryOptions:o})]})},A="/grouping-correlation-matrix";function Y(){var e=a.a.useState(null),t=Object(s.a)(e,2),n=t[0],r=t[1],o=a.a.useState(null),c=Object(s.a)(o,2),i=c[0],u=c[1];return a.a.useEffect((function(){(new f.a).load("".concat(A,"/fonts/Raleway_Regular.json"),(function(e){u(e)})),fetch("".concat(A,"/data/germany_housing_data.csv")).then((function(e){return e.text()})).then((function(e){var t=v.a.parse(e).data,n=t[0],o=t.slice(1).map((function(e){var t={};return n.forEach((function(n,r){if(x.includes(n)){var o=Number.parseFloat(e[r]);Number.isNaN(o)||(t[n]=o)}else if(w.includes(n)){var a;(null===(a=e[r])||void 0===a?void 0:a.length)&&(t[n]=e[r])}})),t}));r(o)}))}),[]),Object(F.jsx)("div",{style:{position:"absolute",top:0,right:0,bottom:0,left:0},children:n&&i?Object(F.jsx)(z,{data:n,font:i}):Object(F.jsx)("div",{style:{position:"absolute",top:"calc(50% - 100px)",left:"calc(50% - 100px)"},children:Object(F.jsx)(l.a,{color:"#6600cc",loading:!0,size:100})})})}var q=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,174)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),a(e),c(e)}))};i.a.render(Object(F.jsx)(a.a.StrictMode,{children:Object(F.jsx)(Y,{})}),document.getElementById("root")),q()},82:function(e,t,n){}},[[173,1,2]]]);
//# sourceMappingURL=main.a7ce61f7.chunk.js.map
(this.webpackJsonppv251_project=this.webpackJsonppv251_project||[]).push([[0],{173:function(e,t,n){"use strict";n.r(t);var r,o=n(0),a=n.n(o),c=n(16),i=n.n(c),s=(n(82),n(12)),l=n(77),u=n.n(l),h=n(68),f=n(69),v=n.n(f),m=n(17),b=n(1),p=n(2),j=function(e){return e.reduce((function(e,t){return e+t}),0)},d=function(e){var t=Math.ceil(100*(e<0?-e:0)),n=Math.ceil(100*(e>0?e:0));return"rgb(".concat(t,"%, 0%, ").concat(n,"%)")},g=function(){function e(t,n,r,o){Object(b.a)(this,e),this.name=t,this.columns=n,this.values=void 0,this.itemsCount=void 0,this.itemsCount=r.length,this.values=n.map((function(e,t){return n.map((function(n,a){if(a>=t)return null;var c=r.filter((function(t){return t.hasOwnProperty(n)&&t.hasOwnProperty(e)}));if(!c.length)return 0;var i=c.map((function(e){return e[n]})),s=c.map((function(t){return t[e]}));return o(i,s)}))}))}return Object(p.a)(e,[{key:"dimensionsCount",get:function(){return this.columns.length}}]),e}(),C=function(){function e(t,n,r,o){Object(b.a)(this,e),this.numericalCols=r,this.submatrices=[];var a,c={},i=Object(m.a)(t);try{for(i.s();!(a=i.n()).done;){var l=a.value,u=l[n];null!=u&&(u in c?c[u].push(l):c[u]=[l])}}catch(d){i.e(d)}finally{i.f()}for(var h=0,f=Object.entries(c);h<f.length;h++){var v=Object(s.a)(f[h],2),p=v[0],j=v[1];this.submatrices.push(new g(p,r,j,o))}}return Object(p.a)(e,[{key:"levelsCount",get:function(){return this.submatrices.length}},{key:"numericalColsCount",get:function(){return this.numericalCols.length}}]),e}(),O=["Price","Living_space","Lot","Usable_area","Rooms","Bedrooms","Bathrooms","Floors","Year_built","Year_renovated","Energy_consumption","Garages"],x=["Type","Furnishing_quality","Condition","Heating","State","City","Garagetype"],w=[{value:"pearson",label:"Pearson Rho",func:function(e,t){var n=j(e)/e.length,r=j(t)/t.length,o=e.reduce((function(e,t){return e+Math.pow(t-n,2)}),0)/e.length,a=t.reduce((function(e,t){return e+Math.pow(t-r,2)}),0)/t.length,c=Math.sqrt(o),i=Math.sqrt(a);if(c>0&&i>0){for(var s=0,l=0;l<e.length;l++)s+=(e[l]-n)*(t[l]-r);return s/e.length/(c*i)}return 0}},{value:"spearman",label:"Spearman Rho",func:function(e,t){if(e.length<=1)return 0;for(var n=e.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})),r=t.map((function(e,t){return[t,e]})).sort((function(e,t){return e[1]-t[1]})),o=0,a=0;a<e.length;a++)o+=Math.pow(n[a][0]-r[a][0],2);return 1-6*o/(e.length*(Math.pow(e.length,2)-1))}}];!function(e){e.PERSPECTIVE="perspective",e.ORTHOGRAPHIC="orthographic"}(r||(r={}));var y=10066329,M=1052688,S=.2,L=n(8),E=n(23),P=n(70),B=function(){var e=Object(E.b)(),t=e.gl,n=e.camera,r=a.a.useMemo((function(){return n.position.set(10,10,-10),new P.a(n,t.domElement)}),[n,t.domElement]);return a.a.useEffect((function(){return function(){r.dispose()}}),[r]),null},T=n(78),k=n(5);var D=n(10),F=function(e){var t=e.font,n=e.matrix,r=e.controlState,o=Object(E.b)(),c=o.camera,i=o.scene,s=o.gl;a.a.useEffect((function(){new T.a(s,i,c)}),[c,i,s]);var l=a.a.useMemo((function(){return function(e,t){var n=new k.Object3D,r=new k.BoxGeometry(1,1,1),o=[];return e.submatrices.forEach((function(e,a){var c=new k.Object3D;e.values.forEach((function(e,n){e.forEach((function(e,o){if(null==e||e>-t&&e<t)return null;var i=new k.Color(d(e)),s=new k.MeshStandardMaterial({color:i,transparent:!0,opacity:Math.abs(e)}),l=new k.Mesh(r,s);l.position.set(o+.5,a+.5,n+.5),l.scale.set(S,S,S),c.add(l)}))})),o.push(c),n.add(c)})),{anchor:n,levelGroups:o}}(n,r.correlationThreshold)}),[n,r.correlationThreshold]),u=l.anchor,h=l.levelGroups,f=a.a.useMemo((function(){return function(e,t){var n=[],r=new k.Object3D,o=new k.LineBasicMaterial({color:M,side:k.DoubleSide});e.numericalCols.forEach((function(a,c){var i=t.generateShapes(a,.5),s=new k.ShapeGeometry(i);s.rotateX(-Math.PI/2),s.rotateY(Math.PI/2);var l=new k.Mesh(s,o);l.position.z=-1,l.position.x=c+.7,r.add(l),n.push(new k.Vector3(c,0,-5)),n.push(new k.Vector3(c,0,e.numericalColsCount))})),n.push(new k.Vector3(e.numericalColsCount,0,-5)),n.push(new k.Vector3(e.numericalColsCount,0,e.numericalColsCount)),e.numericalCols.forEach((function(a,c){var i=t.generateShapes(a,.5),s=new k.ShapeGeometry(i);s.computeBoundingBox();var l=s.boundingBox.max.x-s.boundingBox.min.x;s.rotateX(-Math.PI/2),s.rotateY(Math.PI);var u=new k.Mesh(s,o);u.position.z=c+.2,u.position.x=e.numericalColsCount+l+1,r.add(u),n.push(new k.Vector3(0,0,c)),n.push(new k.Vector3(e.numericalColsCount+5,0,c))})),n.push(new k.Vector3(0,0,e.numericalColsCount)),n.push(new k.Vector3(e.numericalColsCount+5,0,e.numericalColsCount));var a=(new k.BufferGeometry).setFromPoints(n),c=new k.LineBasicMaterial({color:M}),i=new k.LineSegments(a,c);r.add(i);var s=e.numericalColsCount+20,l=new k.PlaneGeometry(s,s),u=new k.MeshBasicMaterial({color:16777215,side:k.DoubleSide,opacity:.7,transparent:!0});l.rotateX(Math.PI/2);var h=new k.Mesh(l,u);return h.position.y=-.01,h.position.x=e.numericalColsCount/2,h.position.z=e.numericalColsCount/2,r.add(h),r}(n,t)}),[n,t]),v=a.a.useMemo((function(){return function(e,t){for(var n=[],r=new k.Object3D,o=new k.LineBasicMaterial({color:10066329}),a=0;a<e.levelsCount;a++){var c=new k.Object3D,i=[];i.push(new k.Vector3(0,a+1,-5)),i.push(new k.Vector3(0,a+1,e.numericalColsCount));var s=t.generateShapes("".concat(e.submatrices[a].name," (").concat(e.submatrices[a].itemsCount,")"),.5),l=new k.ShapeGeometry(s),u=new k.LineBasicMaterial({color:y,side:k.DoubleSide});l.rotateY(Math.PI/2);var h=new k.Mesh(l,u);h.position.y=a+.3,h.position.z=-1,c.add(h);var f=(new k.BufferGeometry).setFromPoints(i),v=new k.LineSegments(f,o);c.add(v),r.add(c),n.push(c)}return{anchor:r,levelDescriptions:n}}(n,t)}),[n,t]),m=v.anchor,b=v.levelDescriptions;return a.a.useEffect((function(){u.position.y=-r.currentLevel,m.position.y=-r.currentLevel,h.forEach((function(e,t){e.traverse((function(e){if(e instanceof k.Mesh){var n=e,o=t>=r.currentLevel&&t<r.currentLevel+r.visibleLevels?1:S;n.scale.set(o,o,o)}}))})),b.forEach((function(e,t){e.traverse((function(e){e instanceof k.Mesh&&e.material.color.set(t>=r.currentLevel&&t<r.currentLevel+r.visibleLevels?26112:y)}))}))}),[h,b,u,m,r]),Object(D.jsx)(a.a.Fragment,{children:Object(D.jsxs)("group",{position:[.75*-n.numericalColsCount,0,.25*-n.numericalColsCount],children:[Object(D.jsx)("primitive",{object:f}),Object(D.jsx)("primitive",{object:m}),Object(D.jsx)("primitive",{object:u})]})})},G=n(28),V=n(53),R=(n(154),function(e){var t=e.actions,n=e.matrix,r=e.controlState,o=a.a.useRef(null);a.a.useEffect((function(){var e=function(e){switch(e.key){case"ArrowUp":t.setControlState((function(e){return Object(L.a)(Object(L.a)({},e),{},{currentLevel:e.currentLevel>=n.levelsCount-1?0:e.currentLevel+1})}));break;case"ArrowDown":t.setControlState((function(e){return Object(L.a)(Object(L.a)({},e),{},{currentLevel:e.currentLevel<=0?n.levelsCount-1:e.currentLevel-1})}))}};return document.addEventListener("keydown",e),function(){document.removeEventListener("keydown",e)}}),[n]);var c=r.correlationThreshold;return a.a.useEffect((function(){if(o.current){var e=o.current,t=e.getContext("2d");if(t){t.clearRect(0,0,e.width,e.height);var r=e.height/n.levelsCount;n.submatrices.forEach((function(e,o){for(var a=0,i=0;i<n.numericalColsCount;i++)for(var s=0;s<n.numericalColsCount;s++)if(!(i<=s)){var l=e.values[i][s];a++,null==l||l>-c&&l<c||(t.globalAlpha=Math.pow(l,2),t.fillStyle=d(l),t.fillRect(2*a,r*(n.levelsCount-1)-o*r,2,r),t.globalAlpha=1)}}))}}}),[n,c]),Object(D.jsxs)("div",{style:{height:"100%",display:"block",position:"relative"},children:[Object(D.jsx)(G.a,{vertical:!0,min:0,max:n.levelsCount,value:r.currentLevel,onChange:function(e){return t.changeControlState({currentLevel:e})}}),Object(D.jsx)("canvas",{ref:o,style:{position:"absolute",left:"40px",top:"0px",width:n.numericalColsCount*(n.numericalColsCount-1),height:"100%"}})]})}),_=function(e){var t=e.controlState,n=e.matrix,r=e.actions,o=e.categoryOptions;return Object(D.jsxs)(a.a.Fragment,{children:[Object(D.jsxs)("div",{className:"controls-pane controls-left-pane",children:[Object(D.jsx)("div",{className:"controls-label",children:"Categorical variable"}),Object(D.jsx)(V.a,{value:t.currentCategory,onChange:function(e){r.changeControlState({currentLevel:0,currentCategory:e})},options:o}),Object(D.jsx)("br",{}),Object(D.jsx)("div",{className:"controls-label",children:"Correlation coefficient"}),Object(D.jsx)(V.a,{value:t.correlationType,onChange:function(e){console.log("newValue",e),r.changeControlState({correlationType:e})},options:w}),Object(D.jsx)("br",{}),Object(D.jsx)("div",{className:"controls-label",children:"Correlation visibility threshold"}),Object(D.jsx)(G.a,{min:.1,max:.9,step:.1,value:t.correlationThreshold,onChange:function(e){return r.changeControlState({correlationThreshold:e})}}),Object(D.jsx)("br",{}),Object(D.jsx)("div",{className:"controls-label",children:"Levels of interest"}),Object(D.jsx)(G.a,{min:1,max:Math.min(10,n.levelsCount),value:t.visibleLevels,onChange:function(e){return r.changeControlState({visibleLevels:e})}})]}),Object(D.jsx)("div",{className:"controls-pane controls-right-pane",children:Object(D.jsx)(R,{actions:r,matrix:n,controlState:t})})]})},I=function(e){var t=e.data,n=e.font,r=a.a.useMemo((function(){var e=x.map((function(e){var n,r={},o=Object(m.a)(t);try{for(o.s();!(n=o.n()).done;){var a=n.value[e];null!=a&&(a in r?r[a]+=1:r[a]=1)}}catch(c){o.e(c)}finally{o.f()}return[e,r]}));return Object.fromEntries(e)}),[t]),o=a.a.useMemo((function(){return x.map((function(e){return{value:e,label:"".concat(e," (").concat(Object.keys(r[e]).length,")")}}))}),[r]),c=a.a.useState({correlationType:w[0],currentCategory:o[0],correlationThreshold:.5,currentLevel:0,visibleLevels:1}),i=Object(s.a)(c,2),l=i[0],u=i[1];console.log("controlState",l);var h=a.a.useMemo((function(){return new C(t,l.currentCategory.value,O,l.correlationType.func)}),[t,l.currentCategory,l.correlationType]),f={setControlState:u,changeControlState:function(e){return u((function(t){return Object(L.a)(Object(L.a)({},t),e)}))}};return Object(D.jsxs)(a.a.Fragment,{children:[Object(D.jsxs)(E.a,{children:[Object(D.jsx)(B,{}),Object(D.jsx)("ambientLight",{}),Object(D.jsx)("pointLight",{position:[10,10,10]}),Object(D.jsx)("color",{attach:"background",args:[1,1,1]}),Object(D.jsx)(F,{font:n,controlState:l,matrix:h})]}),Object(D.jsx)(_,{controlState:l,matrix:h,actions:f,categoryOptions:o})]})};function N(){var e=a.a.useState(null),t=Object(s.a)(e,2),n=t[0],r=t[1],o=a.a.useState(null),c=Object(s.a)(o,2),i=c[0],l=c[1];return a.a.useEffect((function(){var e=new h.a,t="sheater.github.io"===window.location.hostname?"/grouping-correlation-matrix":"";e.load("".concat(t,"/fonts/Raleway_Regular.json"),(function(e){l(e)})),fetch("".concat(t,"/data/germany_housing_data.csv")).then((function(e){return e.text()})).then((function(e){var t=v.a.parse(e).data,n=t[0],o=t.slice(1).map((function(e){var t={};return n.forEach((function(n,r){if(O.includes(n)){var o=Number.parseFloat(e[r]);Number.isNaN(o)||(t[n]=o)}else if(x.includes(n)){var a;(null===(a=e[r])||void 0===a?void 0:a.length)&&(t[n]=e[r])}})),t}));r(o)}))}),[]),Object(D.jsx)("div",{style:{position:"absolute",top:0,right:0,bottom:0,left:0},children:n&&i?Object(D.jsx)(I,{data:n,font:i}):Object(D.jsx)("div",{style:{position:"absolute",top:"calc(50% - 100px)",left:"calc(50% - 100px)"},children:Object(D.jsx)(u.a,{color:"#6600cc",loading:!0,size:100})})})}var z=function(e){e&&e instanceof Function&&n.e(3).then(n.bind(null,174)).then((function(t){var n=t.getCLS,r=t.getFID,o=t.getFCP,a=t.getLCP,c=t.getTTFB;n(e),r(e),o(e),a(e),c(e)}))};i.a.render(Object(D.jsx)(a.a.StrictMode,{children:Object(D.jsx)(N,{})}),document.getElementById("root")),z()},82:function(e,t,n){}},[[173,1,2]]]);
//# sourceMappingURL=main.1fb9ad75.chunk.js.map